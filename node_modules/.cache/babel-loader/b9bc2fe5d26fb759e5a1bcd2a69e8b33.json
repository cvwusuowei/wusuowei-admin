{"ast":null,"code":"import * as imageConversion from 'image-conversion';\nexport default {\n  created() {\n    this.getWebsiteConfig();\n  },\n\n  data: function () {\n    return {\n      websiteConfigForm: {},\n      activeName: 'info',\n      headers: {\n        Authorization: 'Bearer ' + sessionStorage.getItem('token')\n      }\n    };\n  },\n  methods: {\n    getWebsiteConfig() {\n      this.axios.get('/api/admin/website/config').then(({\n        data\n      }) => {\n        this.websiteConfigForm = data.data;\n      });\n    },\n\n    handleAuthorAvatarSuccess(response) {\n      this.websiteConfigForm.authorAvatar = response.data;\n    },\n\n    handleLogoSuccess(response) {\n      this.websiteConfigForm.logo = response.data;\n    },\n\n    handleUserAvatarSuccess(response) {\n      this.websiteConfigForm.userAvatar = response.data;\n    },\n\n    handleTouristAvatarSuccess(response) {\n      this.websiteConfigForm.touristAvatar = response.data;\n    },\n\n    handleWeiXinSuccess(response) {\n      this.websiteConfigForm.weiXinQRCode = response.data;\n    },\n\n    handleAlipaySuccess(response) {\n      this.websiteConfigForm.alipayQRCode = response.data;\n    },\n\n    beforeUpload(file) {\n      return new Promise(resolve => {\n        if (file.size / 1024 < this.config.UPLOAD_SIZE) {\n          resolve(file);\n        }\n\n        imageConversion.compressAccurately(file, this.config.UPLOAD_SIZE).then(res => {\n          resolve(res);\n        });\n      });\n    },\n\n    updateWebsiteConfig() {\n      this.axios.put('/api/admin/website/config', this.websiteConfigForm).then(({\n        data\n      }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA+MA;AAEA;EACAA;IACA;EACA,CAHA;;EAIAC;IACA;MACAC,qBADA;MAEAC,kBAFA;MAGAC;QAAAC;MAAA;IAHA;EAKA,CAVA;EAWAC;IACAC;MACA;QAAAN;MAAA;QACA;MACA,CAFA;IAGA,CALA;;IAMAO;MACA;IACA,CARA;;IASAC;MACA;IACA,CAXA;;IAYAC;MACA;IACA,CAdA;;IAeAC;MACA;IACA,CAjBA;;IAkBAC;MACA;IACA,CApBA;;IAqBAC;MACA;IACA,CAvBA;;IAwBAC;MACA;QACA;UACAC;QACA;;QACAC;UACAD;QACA,CAFA;MAGA,CAPA;IAQA,CAjCA;;IAkCAE;MACA;QAAAhB;MAAA;QACA;UACA;YACAiB,WADA;YAEAC;UAFA;QAIA,CALA,MAKA;UACA;YACAD,WADA;YAEAC;UAFA;QAIA;MACA,CAZA;IAaA;;EAhDA;AAXA","names":["created","data","websiteConfigForm","activeName","headers","Authorization","methods","getWebsiteConfig","handleAuthorAvatarSuccess","handleLogoSuccess","handleUserAvatarSuccess","handleTouristAvatarSuccess","handleWeiXinSuccess","handleAlipaySuccess","beforeUpload","resolve","imageConversion","updateWebsiteConfig","title","message"],"sourceRoot":"src/views/website","sources":["Website.vue"],"sourcesContent":["<template>\r\n  <el-card class=\"main-card\">\r\n    <el-tabs v-model=\"activeName\">\r\n      <el-tab-pane label=\"网站信息\" name=\"info\">\r\n        <el-form label-width=\"100px\" :model=\"websiteConfigForm\" label-position=\"left\">\r\n          <el-form-item label=\"作者头像\">\r\n            <el-upload\r\n              class=\"avatar-uploader\"\r\n              action=\"/api/admin/config/images\"\r\n              :headers=\"headers\"\r\n              :show-file-list=\"false\"\r\n              :before-upload=\"beforeUpload\"\r\n              :on-success=\"handleAuthorAvatarSuccess\">\r\n              <img v-if=\"websiteConfigForm.authorAvatar\" :src=\"websiteConfigForm.authorAvatar\" class=\"avatar\" />\r\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\r\n            </el-upload>\r\n          </el-form-item>\r\n          <el-form-item label=\"网站logo\">\r\n            <el-upload\r\n              class=\"avatar-uploader\"\r\n              action=\"/api/admin/config/images\"\r\n              :headers=\"headers\"\r\n              :show-file-list=\"false\"\r\n              :before-upload=\"beforeUpload\"\r\n              :on-success=\"handleLogoSuccess\">\r\n              <img v-if=\"websiteConfigForm.logo\" :src=\"websiteConfigForm.logo\" class=\"avatar\" />\r\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\r\n            </el-upload>\r\n          </el-form-item>\r\n          <el-form-item label=\"网站名称\">\r\n            <el-input v-model=\"websiteConfigForm.name\" size=\"small\" style=\"width: 400px\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"网站英文名称\">\r\n            <el-input v-model=\"websiteConfigForm.englishName\" size=\"small\" style=\"width: 400px\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"网站作者\">\r\n            <el-input v-model=\"websiteConfigForm.author\" size=\"small\" style=\"width: 400px\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"作者介绍\">\r\n            <el-input v-model=\"websiteConfigForm.authorIntro\" size=\"small\" style=\"width: 400px\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"多语言\">\r\n            <el-radio-group v-model=\"websiteConfigForm.multiLanguage\">\r\n              <el-radio :label=\"0\">关闭</el-radio>\r\n              <el-radio :label=\"1\">开启</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"网站创建日期\">\r\n            <el-date-picker\r\n              style=\"width: 400px\"\r\n              value-format=\"yyyy-MM-dd\"\r\n              v-model=\"websiteConfigForm.websiteCreateTime\"\r\n              type=\"date\"\r\n              placeholder=\"选择日期\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"网站公告\">\r\n            <el-input\r\n              v-model=\"websiteConfigForm.notice\"\r\n              placeholder=\"请输入公告内容\"\r\n              style=\"width: 400px\"\r\n              type=\"textarea\"\r\n              :rows=\"5\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"备案号\">\r\n            <el-input v-model=\"websiteConfigForm.beianNumber\" size=\"small\" style=\"width: 400px\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"qq登录\">\r\n            <el-radio-group v-model=\"websiteConfigForm.qqLogin\">\r\n              <el-radio :label=\"0\">关闭</el-radio>\r\n              <el-radio :label=\"1\">开启</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-button type=\"primary\" size=\"medium\" style=\"margin-left: 6.3rem\" @click=\"updateWebsiteConfig\">\r\n            修改\r\n          </el-button>\r\n        </el-form>\r\n      </el-tab-pane>\r\n      <el-tab-pane label=\"社交信息\" name=\"notice\">\r\n        tip:空白默认不显示\r\n        <el-form label-width=\"70px\" :model=\"websiteConfigForm\">\r\n          <el-form-item label=\"Github\">\r\n            <el-input v-model=\"websiteConfigForm.github\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"Gitee\">\r\n            <el-input v-model=\"websiteConfigForm.gitee\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"QQ\">\r\n            <el-input v-model=\"websiteConfigForm.qq\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"WeChat\">\r\n            <el-input v-model=\"websiteConfigForm.weChat\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"微博\">\r\n            <el-input v-model=\"websiteConfigForm.weibo\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"CSDN\">\r\n            <el-input v-model=\"websiteConfigForm.csdn\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"知乎\">\r\n            <el-input v-model=\"websiteConfigForm.zhihu\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"掘金\">\r\n            <el-input v-model=\"websiteConfigForm.juejin\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"twitter\">\r\n            <el-input v-model=\"websiteConfigForm.twitter\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"stackoverflow\">\r\n            <el-input v-model=\"websiteConfigForm.stackoverflow\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\r\n          </el-form-item>\r\n          <el-button type=\"primary\" size=\"medium\" style=\"margin-left: 4.375rem\" @click=\"updateWebsiteConfig\">\r\n            修改\r\n          </el-button>\r\n        </el-form>\r\n      </el-tab-pane>\r\n\r\n      \r\n      <el-tab-pane label=\"其他设置\" name=\"password\">\r\n        <el-form label-width=\"120px\" :model=\"websiteConfigForm\" label-position=\"left\">\r\n          <el-row style=\"width: 600px\">\r\n            <el-col :md=\"12\">\r\n              <el-form-item label=\"用户头像\">\r\n                <el-upload\r\n                  class=\"avatar-uploader\"\r\n                  action=\"/api/admin/config/images\"\r\n                  :headers=\"headers\"\r\n                  :show-file-list=\"false\"\r\n                  :before-upload=\"beforeUpload\"\r\n                  :on-success=\"handleUserAvatarSuccess\">\r\n                  <img v-if=\"websiteConfigForm.userAvatar\" :src=\"websiteConfigForm.userAvatar\" class=\"avatar\" />\r\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\r\n                </el-upload>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :md=\"12\">\r\n              <el-form-item label=\"游客头像\">\r\n                <el-upload\r\n                  class=\"avatar-uploader\"\r\n                  action=\"/api/admin/config/images\"\r\n                  :headers=\"headers\"\r\n                  :show-file-list=\"false\"\r\n                  :before-upload=\"beforeUpload\"\r\n                  :on-success=\"handleTouristAvatarSuccess\">\r\n                  <img v-if=\"websiteConfigForm.touristAvatar\" :src=\"websiteConfigForm.touristAvatar\" class=\"avatar\" />\r\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\r\n                </el-upload>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-form-item label=\"邮箱通知\">\r\n            <el-radio-group v-model=\"websiteConfigForm.isEmailNotice\">\r\n              <el-radio :label=\"1\">开启</el-radio>\r\n              <el-radio :label=\"0\">关闭</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"评论审核\">\r\n            <el-radio-group v-model=\"websiteConfigForm.isCommentReview\">\r\n              <el-radio :label=\"1\">开启</el-radio>\r\n              <el-radio :label=\"0\">关闭</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"打赏状态\">\r\n            <el-radio-group v-model=\"websiteConfigForm.isReward\">\r\n              <el-radio :label=\"1\">开启</el-radio>\r\n              <el-radio :label=\"0\">关闭</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-row style=\"width: 600px\" v-show=\"websiteConfigForm.isReward == 1\">\r\n            <el-col :md=\"12\">\r\n              <el-form-item label=\"微信收款码\">\r\n                <el-upload\r\n                  class=\"avatar-uploader\"\r\n                  action=\"/api/admin/config/images\"\r\n                  :headers=\"headers\"\r\n                  :show-file-list=\"false\"\r\n                  :before-upload=\"beforeUpload\"\r\n                  :on-success=\"handleWeiXinSuccess\">\r\n                  <img v-if=\"websiteConfigForm.weiXinQRCode\" :src=\"websiteConfigForm.weiXinQRCode\" class=\"avatar\" />\r\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\r\n                </el-upload>\r\n              </el-form-item>\r\n            </el-col>\r\n            <el-col :md=\"12\">\r\n              <el-form-item label=\"支付宝收款码\">\r\n                <el-upload\r\n                  class=\"avatar-uploader\"\r\n                  action=\"/api/admin/config/images\"\r\n                  :headers=\"headers\"\r\n                  :show-file-list=\"false\"\r\n                  :before-upload=\"beforeUpload\"\r\n                  :on-success=\"handleAlipaySuccess\">\r\n                  <img v-if=\"websiteConfigForm.alipayQRCode\" :src=\"websiteConfigForm.alipayQRCode\" class=\"avatar\" />\r\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\r\n                </el-upload>\r\n              </el-form-item>\r\n            </el-col>\r\n          </el-row>\r\n          <el-button type=\"primary\" size=\"medium\" style=\"margin-left: 6.3rem\" @click=\"updateWebsiteConfig\">\r\n            修改\r\n          </el-button>\r\n        </el-form>\r\n      </el-tab-pane>\r\n    </el-tabs>\r\n  </el-card>\r\n</template>\r\n\r\n<script>\r\nimport * as imageConversion from 'image-conversion'\r\n\r\nexport default {\r\n  created() {\r\n    this.getWebsiteConfig()\r\n  },\r\n  data: function () {\r\n    return {\r\n      websiteConfigForm: {},\r\n      activeName: 'info',\r\n      headers: { Authorization: 'Bearer ' + sessionStorage.getItem('token') }\r\n    }\r\n  },\r\n  methods: {\r\n    getWebsiteConfig() {\r\n      this.axios.get('/api/admin/website/config').then(({ data }) => {\r\n        this.websiteConfigForm = data.data\r\n      })\r\n    },\r\n    handleAuthorAvatarSuccess(response) {\r\n      this.websiteConfigForm.authorAvatar = response.data\r\n    },\r\n    handleLogoSuccess(response) {\r\n      this.websiteConfigForm.logo = response.data\r\n    },\r\n    handleUserAvatarSuccess(response) {\r\n      this.websiteConfigForm.userAvatar = response.data\r\n    },\r\n    handleTouristAvatarSuccess(response) {\r\n      this.websiteConfigForm.touristAvatar = response.data\r\n    },\r\n    handleWeiXinSuccess(response) {\r\n      this.websiteConfigForm.weiXinQRCode = response.data\r\n    },\r\n    handleAlipaySuccess(response) {\r\n      this.websiteConfigForm.alipayQRCode = response.data\r\n    },\r\n    beforeUpload(file) {\r\n      return new Promise((resolve) => {\r\n        if (file.size / 1024 < this.config.UPLOAD_SIZE) {\r\n          resolve(file)\r\n        }\r\n        imageConversion.compressAccurately(file, this.config.UPLOAD_SIZE).then((res) => {\r\n          resolve(res)\r\n        })\r\n      })\r\n    },\r\n    updateWebsiteConfig() {\r\n      this.axios.put('/api/admin/website/config', this.websiteConfigForm).then(({ data }) => {\r\n        if (data.flag) {\r\n          this.$notify.success({\r\n            title: '成功',\r\n            message: data.message\r\n          })\r\n        } else {\r\n          this.$notify.error({\r\n            title: '失败',\r\n            message: data.message\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409eff;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 120px;\r\n  height: 120px;\r\n  line-height: 120px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 120px;\r\n  height: 120px;\r\n  display: block;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}