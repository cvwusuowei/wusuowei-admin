{"ast":null,"code":"import * as imageConversion from 'image-conversion';\nexport default {\n  created() {\n    this.getAbout();\n  },\n  data: function () {\n    return {\n      aboutContent: ''\n    };\n  },\n  methods: {\n    getAbout() {\n      this.axios.get('/api/about').then(({\n        data\n      }) => {\n        this.aboutContent = data.data.content;\n      });\n    },\n    uploadImg(pos, file) {\n      var formdata = new FormData();\n      if (file.size / 1024 < this.config.UPLOAD_SIZE) {\n        formdata.append('file', file);\n        this.axios.post('/api/admin/articles/images', formdata).then(({\n          data\n        }) => {\n          this.$refs.md.$img2Url(pos, data.data);\n        });\n      } else {\n        imageConversion.compressAccurately(file, this.config.UPLOAD_SIZE).then(res => {\n          formdata.append('file', new window.File([res], file.name, {\n            type: file.type\n          }));\n          this.axios.post('/api/admin/articles/images', formdata).then(({\n            data\n          }) => {\n            this.$refs.md.$img2Url(pos, data.data);\n          });\n        });\n      }\n    },\n    updateAbout() {\n      this.axios.put('/api/admin/about', {\n        content: this.aboutContent\n      }).then(({\n        data\n      }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["imageConversion","created","getAbout","data","aboutContent","methods","axios","get","then","content","uploadImg","pos","file","formdata","FormData","size","config","UPLOAD_SIZE","append","post","$refs","md","$img2Url","compressAccurately","res","window","File","name","type","updateAbout","put","flag","$notify","success","title","message","error"],"sources":["src/views/about/About.vue"],"sourcesContent":["<template>\r\n  <el-card class=\"main-card\">\r\n    <div class=\"title\">{{ this.$route.name }}</div>\r\n    <mavon-editor\r\n      ref=\"md\"\r\n      @imgAdd=\"uploadImg\"\r\n      v-model=\"aboutContent\"\r\n      style=\"height: calc(100vh - 250px); margin-top: 2.25rem\" />\r\n    <el-button type=\"danger\" size=\"medium\" class=\"edit-btn\" @click=\"updateAbout\"> 修改 </el-button>\r\n  </el-card>\r\n</template>\r\n\r\n\r\n<script>\r\nimport * as imageConversion from 'image-conversion'\r\nexport default {\r\n  created() {\r\n    this.getAbout()\r\n  },\r\n  data: function () {\r\n    return {\r\n      aboutContent: ''\r\n    }\r\n  },\r\n  methods: {\r\n    getAbout() {\r\n      this.axios.get('/api/about').then(({ data }) => {\r\n        this.aboutContent = data.data.content\r\n      })\r\n    },\r\n    uploadImg(pos, file) {\r\n      var formdata = new FormData()\r\n      if (file.size / 1024 < this.config.UPLOAD_SIZE) {\r\n        formdata.append('file', file)\r\n        this.axios.post('/api/admin/articles/images', formdata).then(({ data }) => {\r\n          this.$refs.md.$img2Url(pos, data.data)\r\n        })\r\n      } else {\r\n        imageConversion.compressAccurately(file, this.config.UPLOAD_SIZE).then((res) => {\r\n          formdata.append('file', new window.File([res], file.name, { type: file.type }))\r\n          this.axios.post('/api/admin/articles/images', formdata).then(({ data }) => {\r\n            this.$refs.md.$img2Url(pos, data.data)\r\n          })\r\n        })\r\n      }\r\n    },\r\n    updateAbout() {\r\n      this.axios\r\n        .put('/api/admin/about', {\r\n          content: this.aboutContent\r\n        })\r\n        .then(({ data }) => {\r\n          if (data.flag) {\r\n            this.$notify.success({\r\n              title: '成功',\r\n              message: data.message\r\n            })\r\n          } else {\r\n            this.$notify.error({\r\n              title: '失败',\r\n              message: data.message\r\n            })\r\n          }\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.edit-btn {\r\n  float: right;\r\n  margin: 1rem 0;\r\n}\r\n</style>\r\n"],"mappings":"AAcA,YAAAA,eAAA;AACA;EACAC,QAAA;IACA,KAAAC,QAAA;EACA;EACAC,IAAA,WAAAA,CAAA;IACA;MACAC,YAAA;IACA;EACA;EACAC,OAAA;IACAH,SAAA;MACA,KAAAI,KAAA,CAAAC,GAAA,eAAAC,IAAA;QAAAL;MAAA;QACA,KAAAC,YAAA,GAAAD,IAAA,CAAAA,IAAA,CAAAM,OAAA;MACA;IACA;IACAC,UAAAC,GAAA,EAAAC,IAAA;MACA,IAAAC,QAAA,OAAAC,QAAA;MACA,IAAAF,IAAA,CAAAG,IAAA,eAAAC,MAAA,CAAAC,WAAA;QACAJ,QAAA,CAAAK,MAAA,SAAAN,IAAA;QACA,KAAAN,KAAA,CAAAa,IAAA,+BAAAN,QAAA,EAAAL,IAAA;UAAAL;QAAA;UACA,KAAAiB,KAAA,CAAAC,EAAA,CAAAC,QAAA,CAAAX,GAAA,EAAAR,IAAA,CAAAA,IAAA;QACA;MACA;QACAH,eAAA,CAAAuB,kBAAA,CAAAX,IAAA,OAAAI,MAAA,CAAAC,WAAA,EAAAT,IAAA,CAAAgB,GAAA;UACAX,QAAA,CAAAK,MAAA,aAAAO,MAAA,CAAAC,IAAA,EAAAF,GAAA,GAAAZ,IAAA,CAAAe,IAAA;YAAAC,IAAA,EAAAhB,IAAA,CAAAgB;UAAA;UACA,KAAAtB,KAAA,CAAAa,IAAA,+BAAAN,QAAA,EAAAL,IAAA;YAAAL;UAAA;YACA,KAAAiB,KAAA,CAAAC,EAAA,CAAAC,QAAA,CAAAX,GAAA,EAAAR,IAAA,CAAAA,IAAA;UACA;QACA;MACA;IACA;IACA0B,YAAA;MACA,KAAAvB,KAAA,CACAwB,GAAA;QACArB,OAAA,OAAAL;MACA,GACAI,IAAA;QAAAL;MAAA;QACA,IAAAA,IAAA,CAAA4B,IAAA;UACA,KAAAC,OAAA,CAAAC,OAAA;YACAC,KAAA;YACAC,OAAA,EAAAhC,IAAA,CAAAgC;UACA;QACA;UACA,KAAAH,OAAA,CAAAI,KAAA;YACAF,KAAA;YACAC,OAAA,EAAAhC,IAAA,CAAAgC;UACA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}