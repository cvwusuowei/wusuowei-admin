{"ast":null,"code":"import * as imageConversion from 'image-conversion';\nexport default {\n  created() {\n    this.getAbout();\n  },\n\n  data: function () {\n    return {\n      aboutContent: ''\n    };\n  },\n  methods: {\n    getAbout() {\n      this.axios.get('/api/about').then(({\n        data\n      }) => {\n        this.aboutContent = data.data.content;\n      });\n    },\n\n    uploadImg(pos, file) {\n      var formdata = new FormData();\n\n      if (file.size / 1024 < this.config.UPLOAD_SIZE) {\n        formdata.append('file', file);\n        this.axios.post('/api/admin/articles/images', formdata).then(({\n          data\n        }) => {\n          this.$refs.md.$img2Url(pos, data.data);\n        });\n      } else {\n        imageConversion.compressAccurately(file, this.config.UPLOAD_SIZE).then(res => {\n          formdata.append('file', new window.File([res], file.name, {\n            type: file.type\n          }));\n          this.axios.post('/api/admin/articles/images', formdata).then(({\n            data\n          }) => {\n            this.$refs.md.$img2Url(pos, data.data);\n          });\n        });\n      }\n    },\n\n    updateAbout() {\n      this.axios.put('/api/admin/about', {\n        content: this.aboutContent\n      }).then(({\n        data\n      }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAaA;AACA;EACAA;IACA;EACA,CAHA;;EAIAC;IACA;MACAC;IADA;EAGA,CARA;EASAC;IACAC;MACA;QAAAH;MAAA;QACA;MACA,CAFA;IAGA,CALA;;IAMAI;MACA;;MACA;QACAC;QACA;UAAAL;QAAA;UACA;QACA,CAFA;MAGA,CALA,MAKA;QACAM;UACAD;YAAAE;UAAA;UACA;YAAAP;UAAA;YACA;UACA,CAFA;QAGA,CALA;MAMA;IACA,CArBA;;IAsBAQ;MACA,WACAC,GADA,CACA,kBADA,EACA;QACAC;MADA,CADA,EAIAC,IAJA,CAIA;QAAAX;MAAA;QACA;UACA;YACAY,WADA;YAEAC;UAFA;QAIA,CALA,MAKA;UACA;YACAD,WADA;YAEAC;UAFA;QAIA;MACA,CAhBA;IAiBA;;EAxCA;AATA","names":["created","data","aboutContent","methods","getAbout","uploadImg","formdata","imageConversion","type","updateAbout","put","content","then","title","message"],"sourceRoot":"src/views/about","sources":["About.vue"],"sourcesContent":["<template>\r\n  <el-card class=\"main-card\">\r\n    <div class=\"title\">{{ this.$route.name }}</div>\r\n    <mavon-editor\r\n      ref=\"md\"\r\n      @imgAdd=\"uploadImg\"\r\n      v-model=\"aboutContent\"\r\n      style=\"height: calc(100vh - 250px); margin-top: 2.25rem\" />\r\n    <el-button type=\"danger\" size=\"medium\" class=\"edit-btn\" @click=\"updateAbout\"> 修改 </el-button>\r\n  </el-card>\r\n</template>\r\n\r\n<script>\r\nimport * as imageConversion from 'image-conversion'\r\nexport default {\r\n  created() {\r\n    this.getAbout()\r\n  },\r\n  data: function () {\r\n    return {\r\n      aboutContent: ''\r\n    }\r\n  },\r\n  methods: {\r\n    getAbout() {\r\n      this.axios.get('/api/about').then(({ data }) => {\r\n        this.aboutContent = data.data.content\r\n      })\r\n    },\r\n    uploadImg(pos, file) {\r\n      var formdata = new FormData()\r\n      if (file.size / 1024 < this.config.UPLOAD_SIZE) {\r\n        formdata.append('file', file)\r\n        this.axios.post('/api/admin/articles/images', formdata).then(({ data }) => {\r\n          this.$refs.md.$img2Url(pos, data.data)\r\n        })\r\n      } else {\r\n        imageConversion.compressAccurately(file, this.config.UPLOAD_SIZE).then((res) => {\r\n          formdata.append('file', new window.File([res], file.name, { type: file.type }))\r\n          this.axios.post('/api/admin/articles/images', formdata).then(({ data }) => {\r\n            this.$refs.md.$img2Url(pos, data.data)\r\n          })\r\n        })\r\n      }\r\n    },\r\n    updateAbout() {\r\n      this.axios\r\n        .put('/api/admin/about', {\r\n          content: this.aboutContent\r\n        })\r\n        .then(({ data }) => {\r\n          if (data.flag) {\r\n            this.$notify.success({\r\n              title: '成功',\r\n              message: data.message\r\n            })\r\n          } else {\r\n            this.$notify.error({\r\n              title: '失败',\r\n              message: data.message\r\n            })\r\n          }\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.edit-btn {\r\n  float: right;\r\n  margin: 1rem 0;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}