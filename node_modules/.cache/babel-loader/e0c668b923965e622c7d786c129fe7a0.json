{"ast":null,"code":"export default {\n  created() {\n    this.listResources();\n  },\n\n  data() {\n    return {\n      loading: true,\n      keywords: '',\n      resources: [],\n      addModule: false,\n      addResource: false,\n      resourceForm: {}\n    };\n  },\n\n  methods: {\n    listResources() {\n      this.axios.get('/api/admin/resources', {\n        params: {\n          keywords: this.keywords\n        }\n      }).then(({\n        data\n      }) => {\n        this.resources = data.data;\n        this.loading = false;\n      });\n    },\n\n    changeResource(resource) {\n      this.axios.post('/api/admin/resources', resource).then(({\n        data\n      }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n          this.listResources();\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n      });\n    },\n\n    openModel(resource) {\n      if (resource != null) {\n        this.resourceForm = JSON.parse(JSON.stringify(resource));\n        this.$refs.moduleTitle.innerHTML = '修改模块';\n      } else {\n        this.resourceForm = {};\n        this.$refs.moduleTitle.innerHTML = '添加模块';\n      }\n\n      this.addModule = true;\n    },\n\n    openEditResourceModel(resource) {\n      if (resource.url == null) {\n        this.openModel(resource);\n        return false;\n      }\n\n      this.resourceForm = JSON.parse(JSON.stringify(resource));\n      this.$refs.resourceTitle.innerHTML = '修改资源';\n      this.addResource = true;\n    },\n\n    openAddResourceModel(resource) {\n      console.log(resource);\n      this.resourceForm = {};\n      this.resourceForm.parentId = resource.id;\n      this.$refs.resourceTitle.innerHTML = '添加资源';\n      this.addResource = true;\n    },\n\n    deleteResource(id) {\n      this.axios.delete('/api/admin/resources/' + id).then(({\n        data\n      }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n          this.listResources();\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n      });\n    },\n\n    addOrEditResource() {\n      if (this.resourceForm.resourceName.trim() == '') {\n        this.$message.error('资源名不能为空');\n        return false;\n      }\n\n      this.axios.post('/api/admin/resources', this.resourceForm).then(({\n        data\n      }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n          this.listResources();\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n\n        this.addModule = false;\n        this.addResource = false;\n      });\n    }\n\n  },\n  computed: {\n    tagType() {\n      return function (type) {\n        switch (type) {\n          case 'GET':\n            return '';\n\n          case 'POST':\n            return 'success';\n\n          case 'PUT':\n            return 'warning';\n\n          case 'DELETE':\n            return 'danger';\n        }\n      };\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAuGA;EACAA;IACA;EACA,CAHA;;EAIAC;IACA;MACAC,aADA;MAEAC,YAFA;MAGAC,aAHA;MAIAC,gBAJA;MAKAC,kBALA;MAMAC;IANA;EAQA,CAbA;;EAcAC;IACAC;MACA,WACAC,GADA,CACA,sBADA,EACA;QACAC;UACAR;QADA;MADA,CADA,EAMAS,IANA,CAMA;QAAAX;MAAA;QACA;QACA;MACA,CATA;IAUA,CAZA;;IAaAY;MACA;QAAAZ;MAAA;QACA;UACA;YACAa,WADA;YAEAC;UAFA;UAIA;QACA,CANA,MAMA;UACA;YACAD,WADA;YAEAC;UAFA;QAIA;MACA,CAbA;IAcA,CA5BA;;IA6BAC;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;QACA;MACA;;MACA;IACA,CAtCA;;IAuCAC;MACA;QACA;QACA;MACA;;MACA;MACA;MACA;IACA,CA/CA;;IAgDAC;MACAC;MACA;MACA;MACA;MACA;IACA,CAtDA;;IAuDAC;MACA;QAAAnB;MAAA;QACA;UACA;YACAa,WADA;YAEAC;UAFA;UAIA;QACA,CANA,MAMA;UACA;YACAD,WADA;YAEAC;UAFA;QAIA;MACA,CAbA;IAcA,CAtEA;;IAuEAM;MACA;QACA;QACA;MACA;;MACA;QAAApB;MAAA;QACA;UACA;YACAa,WADA;YAEAC;UAFA;UAIA;QACA,CANA,MAMA;UACA;YACAD,WADA;YAEAC;UAFA;QAIA;;QACA;QACA;MACA,CAfA;IAgBA;;EA5FA,CAdA;EA4GAO;IACAC;MACA;QACA;UACA;YACA;;UACA;YACA;;UACA;YACA;;UACA;YACA;QARA;MAUA,CAXA;IAYA;;EAdA;AA5GA","names":["created","data","loading","keywords","resources","addModule","addResource","resourceForm","methods","listResources","get","params","then","changeResource","title","message","openModel","openEditResourceModel","openAddResourceModel","console","deleteResource","addOrEditResource","computed","tagType"],"sourceRoot":"src/views/resource","sources":["Resource.vue"],"sourcesContent":["<template>\r\n  <el-card class=\"main-card\">\r\n    <div class=\"title\">{{ this.$route.name }}</div>\r\n    <div class=\"operation-container\">\r\n      <el-button type=\"primary\" size=\"small\" icon=\"el-icon-plus\" @click=\"openModel(null)\"> 新增模块 </el-button>\r\n      <div style=\"margin-left: auto\">\r\n        <el-input\r\n          v-model=\"keywords\"\r\n          prefix-icon=\"el-icon-search\"\r\n          size=\"small\"\r\n          placeholder=\"请输入资源名\"\r\n          style=\"width: 200px\"\r\n          @keyup.enter.native=\"listResources\" />\r\n        <el-button type=\"primary\" size=\"small\" icon=\"el-icon-search\" style=\"margin-left: 1rem\" @click=\"listResources\">\r\n          搜索\r\n        </el-button>\r\n      </div>\r\n    </div>\r\n    <el-table\r\n      v-loading=\"loading\"\r\n      :data=\"resources\"\r\n      row-key=\"id\"\r\n      :tree-props=\"{ children: 'children', hasChildren: 'hasChildren' }\">\r\n      <el-table-column prop=\"resourceName\" label=\"资源名\" width=\"220\" />\r\n      <el-table-column prop=\"url\" label=\"资源路径\" width=\"300\" />\r\n      <el-table-column prop=\"requetMethod\" label=\"请求方式\">\r\n        <template slot-scope=\"scope\" v-if=\"scope.row.requestMethod\">\r\n          <el-tag :type=\"tagType(scope.row.requestMethod)\">\r\n            {{ scope.row.requestMethod }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"isAnonymous\" label=\"匿名访问\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-switch\r\n            v-if=\"scope.row.url\"\r\n            v-model=\"scope.row.isAnonymous\"\r\n            active-color=\"#13ce66\"\r\n            inactive-color=\"#F4F4F5\"\r\n            :active-value=\"1\"\r\n            :inactive-value=\"0\"\r\n            @change=\"changeResource(scope.row)\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"createTime\" label=\"创建时间\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <i class=\"el-icon-time\" style=\"margin-right: 5px\" />\r\n          {{ scope.row.createTime | date }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" align=\"center\" width=\"200\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button type=\"text\" size=\"mini\" @click=\"openAddResourceModel(scope.row)\" v-if=\"scope.row.children\">\r\n            <i class=\"el-icon-plus\" /> 新增\r\n          </el-button>\r\n          <el-button type=\"text\" size=\"mini\" @click=\"openEditResourceModel(scope.row)\">\r\n            <i class=\"el-icon-edit\" /> 修改\r\n          </el-button>\r\n          <el-popconfirm title=\"确定删除吗？\" style=\"margin-left: 10px\" @confirm=\"deleteResource(scope.row.id)\">\r\n            <el-button size=\"mini\" type=\"text\" slot=\"reference\"> <i class=\"el-icon-delete\" /> 删除 </el-button>\r\n          </el-popconfirm>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-dialog :visible.sync=\"addModule\" width=\"30%\">\r\n      <div class=\"dialog-title-container\" slot=\"title\" ref=\"moduleTitle\" />\r\n      <el-form label-width=\"80px\" size=\"medium\" :model=\"resourceForm\">\r\n        <el-form-item label=\"模块名\">\r\n          <el-input v-model=\"resourceForm.resourceName\" style=\"width: 220px\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"addModule = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"addOrEditResource\"> 确 定 </el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <el-dialog :visible.sync=\"addResource\" width=\"30%\">\r\n      <div class=\"dialog-title-container\" slot=\"title\" ref=\"resourceTitle\" />\r\n      <el-form label-width=\"80px\" size=\"medium\" :model=\"resourceForm\">\r\n        <el-form-item label=\"资源名\">\r\n          <el-input v-model=\"resourceForm.resourceName\" style=\"width: 220px\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"资源路径\">\r\n          <el-input v-model=\"resourceForm.url\" style=\"width: 220px\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"请求方式\">\r\n          <el-radio-group v-model=\"resourceForm.requestMethod\">\r\n            <el-radio :label=\"'GET'\">GET</el-radio>\r\n            <el-radio :label=\"'POST'\">POST</el-radio>\r\n            <el-radio :label=\"'PUT'\">PUT</el-radio>\r\n            <el-radio :label=\"'DELETE'\">DELETE</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"addResource = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"addOrEditResource\"> 确 定 </el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </el-card>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  created() {\r\n    this.listResources()\r\n  },\r\n  data() {\r\n    return {\r\n      loading: true,\r\n      keywords: '',\r\n      resources: [],\r\n      addModule: false,\r\n      addResource: false,\r\n      resourceForm: {}\r\n    }\r\n  },\r\n  methods: {\r\n    listResources() {\r\n      this.axios\r\n        .get('/api/admin/resources', {\r\n          params: {\r\n            keywords: this.keywords\r\n          }\r\n        })\r\n        .then(({ data }) => {\r\n          this.resources = data.data\r\n          this.loading = false\r\n        })\r\n    },\r\n    changeResource(resource) {\r\n      this.axios.post('/api/admin/resources', resource).then(({ data }) => {\r\n        if (data.flag) {\r\n          this.$notify.success({\r\n            title: '成功',\r\n            message: data.message\r\n          })\r\n          this.listResources()\r\n        } else {\r\n          this.$notify.error({\r\n            title: '失败',\r\n            message: data.message\r\n          })\r\n        }\r\n      })\r\n    },\r\n    openModel(resource) {\r\n      if (resource != null) {\r\n        this.resourceForm = JSON.parse(JSON.stringify(resource))\r\n        this.$refs.moduleTitle.innerHTML = '修改模块'\r\n      } else {\r\n        this.resourceForm = {}\r\n        this.$refs.moduleTitle.innerHTML = '添加模块'\r\n      }\r\n      this.addModule = true\r\n    },\r\n    openEditResourceModel(resource) {\r\n      if (resource.url == null) {\r\n        this.openModel(resource)\r\n        return false\r\n      }\r\n      this.resourceForm = JSON.parse(JSON.stringify(resource))\r\n      this.$refs.resourceTitle.innerHTML = '修改资源'\r\n      this.addResource = true\r\n    },\r\n    openAddResourceModel(resource) {\r\n      console.log(resource)\r\n      this.resourceForm = {}\r\n      this.resourceForm.parentId = resource.id\r\n      this.$refs.resourceTitle.innerHTML = '添加资源'\r\n      this.addResource = true\r\n    },\r\n    deleteResource(id) {\r\n      this.axios.delete('/api/admin/resources/' + id).then(({ data }) => {\r\n        if (data.flag) {\r\n          this.$notify.success({\r\n            title: '成功',\r\n            message: data.message\r\n          })\r\n          this.listResources()\r\n        } else {\r\n          this.$notify.error({\r\n            title: '失败',\r\n            message: data.message\r\n          })\r\n        }\r\n      })\r\n    },\r\n    addOrEditResource() {\r\n      if (this.resourceForm.resourceName.trim() == '') {\r\n        this.$message.error('资源名不能为空')\r\n        return false\r\n      }\r\n      this.axios.post('/api/admin/resources', this.resourceForm).then(({ data }) => {\r\n        if (data.flag) {\r\n          this.$notify.success({\r\n            title: '成功',\r\n            message: data.message\r\n          })\r\n          this.listResources()\r\n        } else {\r\n          this.$notify.error({\r\n            title: '失败',\r\n            message: data.message\r\n          })\r\n        }\r\n        this.addModule = false\r\n        this.addResource = false\r\n      })\r\n    }\r\n  },\r\n  computed: {\r\n    tagType() {\r\n      return function (type) {\r\n        switch (type) {\r\n          case 'GET':\r\n            return ''\r\n          case 'POST':\r\n            return 'success'\r\n          case 'PUT':\r\n            return 'warning'\r\n          case 'DELETE':\r\n            return 'danger'\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]},"metadata":{},"sourceType":"module"}